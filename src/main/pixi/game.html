<!DOCTYPE HTML>
<html>
<head>
<title>pixi.js example 1</title>
<style>
body {
	margin: 0;
	padding: 0;
	background-color: #000000;
}
</style>
<script src="resources/pixi.js"></script>
<script src="js/keypress.js"></script>
<script src="js/actor.js"></script>
<script src="js/levels.js"></script>
</head>
<body>
	<script>
	
	// some static information about the world
	var WORLD = { WIDTH:600, HEIGHT:300, FLOOR:200 };
	
	// create an new instance of a pixi stage
	var stage = new PIXI.Stage(0x66FF99);
	
	// create two different containers to add onScreenObjects into
	var background = new PIXI.DisplayObjectContainer();
	var foreground = new PIXI.DisplayObjectContainer();
	stage.addChild(background);
	stage.addChild(foreground);
	
	// when the agent moves, we move the foreground and background in the opposite direction
	// things that are farther away move slower
 	keyLeft = function() { foreground.position.x += 16; background.position.x += 8; };
	keyRight = function() { foreground.position.x -= 16; background.position.x -= 8; };

	// create a renderer instance.
	// TEST on some machines, this will create a WebGLRender, but the bunny will not be drawn
//	var renderer = PIXI.autoDetectRenderer(400, 300);
	var renderer = new PIXI.CanvasRenderer(WORLD.WIDTH, WORLD.HEIGHT);

	// add the renderer view element to the DOM
	document.body.appendChild(renderer.view);
	
	var onScreenObjects = [];
	
	loadMainstreet(background, foreground, onScreenObjects);
	var agent = createActor(stage, WORLD.WIDTH/2);
	
	function animate() {
	    requestAnimFrame( animate );

	    agent.update();
	    for(i in onScreenObjects)
	    	onScreenObjects[i].update();

	    // render the stage   
	    renderer.render(stage);
	}
	
	requestAnimFrame( animate );
	</script>
</body>
</html>
